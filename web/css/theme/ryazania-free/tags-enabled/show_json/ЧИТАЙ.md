# `<cms:show_json>`

Красиво печатаем JSON, объекты и массивы с тегом  **show_json**. Очень полезен тег для работы с массивами [**Couch Arrays**](#related-pages).

```xml
<cms:show_json myjson />
<cms:show_json '{ "id" : "1" }' />
```

На входе принимаем строки и массивы.

## Пример

JSON-строка –

```xml
<cms:show_json '{ "id" : "1" }' />
```

```js
Результат:
{
    "id" : "1"
}
```

Массив в переменной —

```xml
<cms:show_json langcodes />
```

```js
Результат:
[
   "de",
   "fr",
   "es",
   "ru"
]
```

Крутая фишка тега (против дефолтно-стокового вывода `<cms:show myvar as_json='1' />`) это настраиваемые отступы и HTML.

Полный список параметров с их значениями по-умолчанию —

```xml
<cms:show_json value=myvar
    scope=''
    as_html='1'
    html_encode='1'
    escape='0'
    spaces='3'
    monospace='1'
    />
```

Обозрим параметры далее.

## Параметры

* ***value***
* **scope**
* **as_html**
* **html_encode**
* **escape**
* **spaces**
* **monospace**

Первый параметр *безымянный* (ну или __value__) может принимать значение строковое или массива в переменной.

### scope

Всё то же самое как и у [**cms:show**](#related-tags) — ***local***, ***global***

### as_html

Пробелы заменим на `&nbsp;`. По умолчанию включено —

```xml
<cms:show_json climate /> - то же что и - <cms:show_json climate as_html='1' />
```

### html_encode

Начальное значение ***1*** — HTML содержимое в JSON будет закодировано, чтобы браузер не сломал печать когда встретит угловые скобки HTML `<tag>`.

Если прошлый параметр **as_html** поставить в ***0***, тогда **html_encode** тоже отключится в ***0***.

### escape

Часто JSON содержит \\экранированные \\символы. Параметр **escape** (в начале ***0***) улучшает визуально вывод, поскольку убирает экранирование (всё равно оно необязательно).

```json
escape='1':
{
   "k_paginate_link_cur":"http:\/\/my.couch\/worker.php",
   "k_paginate_link_next":"http:\/\/my.couch\/worker.php?pg=2"
}
```

```json
escape='0' (по-умолчанию):
{
   "k_paginate_link_cur":"http://my.couch/worker.php",
   "k_paginate_link_next":"http://my.couch/worker.php?pg=2"
}
```

JSON стандарт **не требует экранирования слешей** (forward slashes), но на всякий случай проверяйте скрипты, которым скармливаете финальный JSON.

### spaces

Ставим любое число пробелов приятное глазу. Обычно ***3***.

```xml
<cms:set climate = '{"Russia":{"Moscow":"cold","Sochi":"warm"}}' is_json='1' />
<cms:show_json climate />

{
   "Russia":{
      "Moscow":"cold",
      "Sochi":"warm"
   }
}
```

Без пробелов ***spaces = '0'*** отступов нет:

```js
{
"Russia":{
"Moscow":"cold",
"Sochi":"warm"
}
```

А с пробелами ***spaces = '5'*** есть:

```js
{
     "Russia":{
          "Moscow":"cold",
          "Sochi":"warm"
     }
}
```

Вывод отформатирован и сконвертирован в **HTML**.

<details><summary>Реальная исходная строка из прошлого примера</summary>

```html
{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Russia&quot;:{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Moscow&quot;:&quot;cold&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Sochi&quot;:&quot;warm&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>}
```
</details>

### monospace

Закроем вывод в пару `<pre>..</pre>`. Обычно ***1***. Не может включиться без HTML, т.е. когда **as_html** - *0*, то и **monospace** - *0*.

---

Если очень нужно вывод сделать так же как и в дефолтном теге, то надо ставить такие значения:

```xml
<cms:show_json climate as_html='0' escape='1' spaces='0' />
```

## Теги в руку

* **show** (с модом на строчные/прописные и поддержкой кодировки)

## Ссылки

* [**Midware Core Concepts » Couch Arrays**](https://github.com/trendoman/Midware/tree/main/concepts/Arrays) - всё-всё про массивы Couch Arrays (на англ.)

## Автор

Пишите по любым вопросам, докидывайте свои примеры.

Антон С.\
tony.smirnov@gmail.com
